(function(a){a.fn.DataFilter=function(r,X){var ax=a.extend({scrollToEnabled:false,useShowResultsButton:false,useApplyButton:false,pageSize:-1,dataElements:{},sortingDropDown:undefined,defaultTableSort:undefined,slidersEnabled:true,extractTextFn:function(aF){return aF.text()},onSuccess:function(){}},X);var aE={element:a(this),elementId:a(this).attr("id"),elementType:a(this).prop("tagName"),filtersInitialised:false,initialised:false,pauseFilter:false,sort:{},paging:{currentPage:1,itemsPerPage:-1,defaultItemsPerPage:Number.MAX_VALUE,totalItems:0,numMatchedItems:0},wrapper:a(document.createElement("div"))};methods={init:function(){if(aH()){R();ax.onSuccess();return this}else{console.log("Invalid use of DataFilter - check above log messages")}function aH(){var aI=true;if(aE.element.length==0){aI=aF("Element defined in initialisation can not be found")}if(a("#filters").length==0){aI=aF("No element with id 'filters'")}if(a(".paginationHolder").length==0){aG("No .paginationHolder class elements for paging")}return aI}function aF(aI){console.log(aI);return false}function aG(aI){console.log(aI)}}};function R(){if(ax.sortingDropDown!=undefined){j(ax.sortingDropDown)}a.each(ax.dataElements,function(aG,aF){au(aG,aF)});an();q();v(ax.pageSize)}function an(){a("#filters").empty();a("#filters").append(aE.wrapper)}function q(){if(aE.elementType=="TABLE"){E()}if(ax.sortingDropDown!=undefined){J(ax.sortingDropDown)}}function au(aI,aG){aE.filtersInitialised=false;sortFn=u[aG.dataType];aE.sort[aG.id]=sortFn;factoryFn=T[aG.filterType];if(aI&&factoryFn){var aF=aG.items;if(aF==undefined){var aH=O[aE.elementType].getAllDataForGivenIdFn(aG.id);aF=G(aH,sortFn)}L(aG.id,aI,factoryFn,aF)}}function v(aG){aE.pauseFilter=false;aE.filtersInitialised=true;aE.paging.defaultItemsPerPage=aG;d(1,aG);if(ax.useApplyButton){M("Apply Filters",p)}else{if(ax.useShowResultsButton){M("Show Results",g)}}if(ax.defaultTableSort){var aF=a("#"+aE.elementId+" thead th:nth-child("+ax.defaultTableSort.id+")");aF.click();if(ax.defaultTableSort.direction&&ax.defaultTableSort.direction=="-1"){aF.click()}}aE.initialised=true}function M(aH,aG){var aF=a(document.createElement("button")).attr({type:"button","class":"btn-style"}).click(function(){aE.pauseFilter=false;aG()}).text(aH);aE.wrapper.append(a(document.createElement("div")).append(aF))}function G(aH,aG){var aF=[];aH.each(function(){var aI=ax.extractTextFn(a(this)).trim();if(aI.length>0&&a.inArray(aI,aF)<0){aF.push(aI)}});compare.sortItems(aF,aG);return aF}function b(){return a("#"+aE.elementId+" tbody tr")}function ay(){return a("ul#"+aE.elementId+">li")}function aa(aF){return a("#"+aE.elementId+" tbody tr td:nth-child("+aF+")")}function w(aF){return a("ul#"+aE.elementId+">li ."+aF)}function m(aG,aF){return ax.extractTextFn(a(aG).children("td").eq(aF))}function S(aG,aF){return ax.extractTextFn(a(aG).find("."+aF))}function d(aF,aG){aE.pauseFilter=false;if(aF){aE.paging.currentPage=aF}if(aE.paging.currentPage<=0){aE.paging.currentPage=1}if(aG){aE.paging.itemsPerPage=parseInt(aG)}if(aE.paging.itemsPerPage<=0){aE.paging.itemsPerPage=Number.MAX_VALUE}p()}function al(){if(!ax.useApplyButton){F()}}function F(){aE.paging.currentPage=1;p()}function p(){if(!aE.filtersInitialised||aE.pauseFilter){aE.pauseFilter=false;return}var aF={};a('#filters [data-role="filterSetSelector"]').each(function(){var aH=this.id.split("_")[0];var aG=this.id.split("_")[1];switch(aH){case"Select":af(aF,aG,P(this.id));break;case"MultiSelect":af(aF,aG,f(this.id));break;case"Checkboxes":af(aF,aG,aA(this.id));break;case"Max":af(aF,aG,s(this.id));break;case"Min":af(aF,aG,ao(this.id));break}});at(n,aF);am();W()}function W(){if((ax.useApplyButton&&aE.initialised)||(utils.exists("#scrollTo")&&ax.scrollToEnabled&&aE.initialised)){g()}}function g(){a("html, body").animate({scrollTop:a("#scrollTo").offset().top},1000)}function af(aH,aG,aF){if(aH[aG]){aH[aG].push(aF)}else{aH[aG]=[aF]}}function at(aI,aG){var aF=0;aE.paging.totalItems=0;aE.paging.numMatchedItems=0;var aH=O[aE.elementType].getAllDataFn();var aJ=utils.now();aH.each(function(){var aK=aI(this,aG);aE.paging.totalItems++;if(aK){if(aj(aF)){a(this).show();aF++}else{a(this).hide()}aE.paging.numMatchedItems++}else{a(this).hide()}});setTimeout(function(){I(aH)},0)}function I(aF){aF.each(function(){if(a(this).css("display")!="none"){a(this).hide().show()}})}function aj(aF){return aE.paging.numMatchedItems>=(aE.paging.currentPage-1)*aE.paging.itemsPerPage&&aF<aE.paging.itemsPerPage}function n(aI,aH,aG){var aF=true;a.each(aH,function(aJ,aK){if(aE.elementType=="TABLE"){aJ=parseInt(aJ)-1}a.each(aK,function(aL){if(aF){aF=A(aI,aJ,aK[aL])}});if(!aF){return false}});return aF}function A(aI,aF,aH){var aG=O[aE.elementType].extractTextFn(aI,aF);return utils.contains(aH,"--M")?ah(aF,aG,aH):Q(aG,aH)}function Q(aG,aF){return aG.search(new RegExp(aF,"i"))>-1}function ah(aI,aJ,aH){var aG=aH.split("_")[1];var aL=aB(aI);var aK=utils.contains(aH,"--MAX--_")?1:-1;var aF=utils.contains(aG,"No M")?true:aL(aG,aJ,aK)>=0;return aF
}function s(aF){return ai(aF,"--MAX--_")}function ao(aF){return ai(aF,"--MIN--_")}function ai(aG,aF){return aF+a("select#"+aG+">option:selected").val()}function Z(aF){return[s("Max_"+aF),ao("Min_"+aF)]}function P(aF){return a("select#"+aF+" option:selected").prop("value")}function f(aG){var aF="";aG=aG.split("_")[1];a("#MultiSelectItems_"+aG+" p").each(function(){aF+=aq(aF,a(this).text())});return aF}function aA(aG){var aF="";a("ul#"+aG+" li input[type=checkbox]").each(function(){if(this.checked){aF+=aq(aF,this.value)}});return aF}function aq(aF,aH){var aG=h(aH);return(aF==""?aG:"|"+aG)}function h(aF){return(utils.startsWith(aF,"~"))?aF.substring(1):H(aF)}function H(aF){return"\\b"+utils.extractCurrencyValue(aF)+"\\b"}function L(aG,aI,aH,aF){az(aI,aH(aF,aG))}function az(aH,aG){var aF=a(document.createElement("div")).attr({"class":"filterSet"});aF.append(a(document.createElement("a")).attr({"class":"filterSelect"}).text(aH));aF.append(aw(aG));aE.wrapper.append(aF)}function aw(aG,aF){return aG.attr({id:aF,"class":"filterContent"})}function ak(aF,aG){return ag(x(aF),aG)}function V(aF,aH){var aG=av(x(aF));return N(aG,aH)}function av(aF){if(aF.length>1){aF.pop()}return aF}function x(aI){var aG=utils.extractCurrencyValue(aI[0]);var aM=utils.extractCurrencyValue(aI[aI.length-1]);var aH=parseInt(aM)-parseInt(aG);var aK=10;if(aH>350){aK=100}else{if(aH>175){aK=50}else{if(aH>75){aK=25}else{if(aH>60){aK=20}}}}var aF=parseInt(aH/aK)+1;var aL=(aG-(aG%aK))+aK;if((aF-1)*aK+aL<aM){aF++}var aJ=[];if(aG==0){aJ.push("Free");aL=aL+aK}for(i=0;i<aF;i++){aJ.push("£"+(aL+i*aK))}return aJ}function c(aF,aI){var aG=a(document.createElement("ul")).attr({id:"MaxMin_"+aI,"class":"MaxMin"});aG.append(C(ad(aI,"Min","From: "),ab(aF,aI,"Min")));aG.append(C(ad(aI,"Max","Up to: "),ab(aF,aI,"Max")));var aH=a(document.createElement("div"));aD(aH,aF,aI,"MaxMin");aH.append(aG);return aH}function C(aG,aF){return a(document.createElement("li")).append(aG).append(aF)}function ag(aF,aG){return Y(aF,aG,"Max","Up to: ")}function N(aF,aG){return Y(aF,aG,"Min","From: ")}function Y(aG,aK,aI,aF){function aH(aL){ap(aK,aL.value);aC(aK,aL.selectedIndex)}var aJ=a(document.createElement("div"));aD(aJ,aG,aK,aI,aH);aJ.append(ad(aK,aI,aF));aJ.append(ab(aG,aK,aI,aF));return aJ}function z(aF,aI){function aG(aJ){var aK="#MultiSelectItems_"+aI;a(aK).append(a(document.createElement("p")).text(aJ.value).prop("class",aJ.selectedIndex).click(function(){a(aJ).append(a(document.createElement("option")).prop("value",a(this).text()).text(a(this).text()));y(a(aJ));a(this).remove();al()}));a(aJ).find("option:selected").remove()}var aH=a(document.createElement("div"));aH.append(ab(aF,aI,"MultiSelect",aG));aH.append(a(document.createElement("div")).attr({id:"MultiSelectItems_"+aI,"class":"multiSelect"}));return aH}function y(aF){var aG=aF.val();aF.html(a("option",aF).sort(function(aI,aH){return aI.text==aH.text?0:aI.text<aH.text?-1:1}));aF.val(aG)}function ab(aG,aJ,aI,aH){if(aI==undefined){aI="Select"}aJ=aI+"_"+aJ;var aF=a(document.createElement("select")).attr({id:aJ,"data-role":"filterSetSelector"});if(aI=="Min"){aF.append(a(document.createElement("option")).text("No Min"))}if(aI=="Select"){aF.append(a(document.createElement("option")).text("All").prop("value",""))}if(aI=="MultiSelect"){aF.append(a(document.createElement("option")).text("Add").prop("value",""))}a.each(aG,function(aL,aK){aF.append(a(document.createElement("option")).prop("value",aK).text(aK))});aF.change(function(aK){aH(this);al()});if(aI=="Max"){aF.append(a(document.createElement("option")).attr({selected:true}).text("No Max"))}return aF}function ad(aH,aG,aF){return a(document.createElement("label")).attr({id:"selectLabel_"+aG+"_"+aH,"class":"selectLabel"}).text(aF)}function aD(aL,aF,aK,aH){if(!ax.slidersEnabled){return aL}aK=aH+"_"+aK;var aG=(aH=="MaxMin")?2:1;var aJ=a(document.createElement("div")).attr({id:"slider_"+aK,"class":"noUiSlider"});aJ.noUiSlider("init",{handles:aG,scale:[0,aF.length],start:[0,aF.length],change:function(){var aM=a(this).noUiSlider("value");B(aK,aM);ap(aK,K(aK,aM))},end:function(){al()}});var aI=a(document.createElement("div")).attr({id:"sliderLabel_"+aK,"class":"noUiSliderLabel"}).text("-");aL.append(aI);aL.append(aJ);if(aH=="Min"){setTimeout(function(){aC(aK,0)},0)}if(aH=="Max"){setTimeout(function(){aC(aK,aF.length)},0)}if(aH=="MaxMin"){setTimeout(function(){aC(aK,aF.length)},0)}return aL}function B(aG,aF){if(utils.contains(aG,"MaxMin")){aG=aG.split("_")[1];a("select#Min_"+aG+" option:eq("+aF[0]+")").attr("selected","selected");a("select#Max_"+aG+" option:eq("+aF[1]+")").attr("selected","selected")}else{a("select#"+aG+" option:eq("+aF[1]+")").attr("selected","selected")}}function K(aJ,aF){if(utils.contains(aJ,"MaxMin")){aJ=aJ.split("_")[1];var aI=a("select#Min_"+aJ+" option:eq("+aF[0]+")").text().trim();var aH=a("select#Max_"+aJ+" option:eq("+aF[1]+")").text().trim();return D(aI,aH)}else{var aG=a("select#"+aJ+" option:eq("+aF[1]+")").text();var aI=(utils.contains(aJ,"Max"))?"No Min":aG;
var aH=(utils.contains(aJ,"Min"))?"No Max":aG;return D(aI,aH)}}function D(aG,aF){if(aG=="No Min"&&aF=="No Max"){return"Show All"}else{if(aF=="No Max"){return"From "+aG}else{if(aG=="No Min"){return"Up to "+aF}else{return aG+" to "+aF}}}}function ap(aG,aF){if(utils.exists("#sliderLabel_"+aG)){a("#sliderLabel_"+aG).text(aF)}}function aC(aH,aG){aE.pauseFilter=true;if(utils.exists("#slider_"+aH)){var aF=(utils.contains(aH,"MaxMin"))?"1":"0";a("#slider_"+aH).noUiSlider("move",{knob:aF,to:aG})}else{var aF=(utils.contains(aH,"Max"))?"1":"0";aH=aH.split("_")[1];if(utils.exists("#slider_MaxMin_"+aH)){a("#slider_MaxMin_"+aH).noUiSlider("move",{knob:aF,to:aG})}}}function ae(aF,aG){var aH=a(document.createElement("ul")).attr({id:"Checkboxes_"+aG,"data-role":"filterSetSelector"});a.each(aF,function(aJ,aI){aH.append(a(document.createElement("li")).attr({"class":"checkboxLi"}).append(l(aI).prepend(ac(aI,aG))))});return aH}function ac(aG,aF){return a(document.createElement("input")).attr({id:aF+"_"+aG,"class":"filterCheckbox",name:aF,value:aG,type:"checkbox",checked:false}).click(function(aH){al()})}function l(aF){aF=utils.startsWith(aF,"~")?aF.substring(1):aF;return a(document.createElement("label")).text(aF)}function am(){a(".paginationHolder").each(function(){a(this).empty().append(ar())})}function ar(){var aL=((aE.paging.currentPage-1)*aE.paging.itemsPerPage)+1;var aK=((aE.paging.currentPage)*aE.paging.itemsPerPage);if(aK>aE.paging.numMatchedItems){aK=aE.paging.numMatchedItems}var aG=parseInt((aE.paging.numMatchedItems/aE.paging.itemsPerPage)+((aE.paging.numMatchedItems%aE.paging.itemsPerPage>0)?1:0));var aJ=(aE.paging.currentPage>1)?aE.paging.currentPage-1:1;var aI=(aE.paging.currentPage<aG)?aE.paging.currentPage+1:aG;if(aI>aG){aI=aG}var aH=a(document.createElement("ul")).attr({"class":"pagination"});aH.append(a(document.createElement("li")).attr({"class":"showing"}).text("Showing "+aL+" - "+aK+" of "+aE.paging.numMatchedItems));e(aH,"&laquo;","Skip to first page",1);e(aH,"&lsaquo;","Skip to previous page",aJ);for(i=1;i<=aG;i++){var aF=a(document.createElement("li"));if(i==aE.paging.currentPage){aF.attr({"class":"active"})}aH.append(aF.append(a(document.createElement("a")).text(i).click(function(aM){d(aM.currentTarget.text)})))}e(aH,"&rsaquo;","Skip to next page",aI);e(aH,"&raquo;","Skip to last page",aG);if(aE.paging.numMatchedItems>aE.paging.itemsPerPage){o(aH,"Show All",1,-1)}else{if(aE.paging.defaultItemsPerPage>0&&aE.paging.itemsPerPage>aE.paging.defaultItemsPerPage){o(aH,"Show Less",1,aE.paging.defaultItemsPerPage)}}return aH}function o(aG,aI,aH,aF){aG.append(a(document.createElement("li")).append(a(document.createElement("a")).attr({"class":"pagingShow"}).text(aI).click(function(aJ){d(aH,aF)})))}function e(aG,aI,aF,aH){aG.append(a(document.createElement("li")).append(a(document.createElement("a")).click(function(aJ){d(aH)}).html(aI)))}function aB(aF){if(a.isNumeric(aF)){aF=parseInt(aF)+1}return aE.sort[aF]}function j(aG){var aF=a(document.createElement("select")).attr({id:"sortBySelect"});aF.append(a(document.createElement("option")).prop("value","sortBy").text("Sort by..."));a.each(aG,function(aH,aJ){var aI=aJ.id+"_"+aJ.direction;aF.append(a(document.createElement("option")).prop("value",aI).text(aH))});aF.change(function(aI){var aH=a("select#sortBySelect>option:selected").val();if(aH!="sortBy"){t(aE.element,O[aE.elementType].getAllDataFn(),aH.split("_")[0],aH.split("_")[1])}});az("Sort by",aF)}function J(aF){var aG=1;a.each(aF,function(aH,aI){if(aI.isDefault){t(aE.element,O[aE.elementType].getAllDataFn(),aI.id,aI.direction);a("#sortBySelect option:eq("+aG+")").attr("selected","selected")}aG++})}function E(){a("#tariffTable thead th").each(function(aF){if(aB(aF)){U(a(this),aF)}})}function U(aG,aF){if(!utils.contains(aG.attr("class"),"sorting")||utils.contains(aG.attr("class"),"sortable")){return}aG.addClass("sortable").click(function(){var aH=a("#tariffTable tbody tr").get();var aJ=aG.is(".sorted-asc")?-1:1;t(a("#tariffTable tbody"),aH,aF,aJ);a("th").removeClass("sorted-asc sorted-desc");var aI=a("th").filter(":nth-child("+(aF+1)+")");aJ==1?aI.addClass("sorted-asc"):aI.addClass("sorted-desc");a("td").removeClass("sorted").filter(":nth-child("+(aF+1)+")").addClass("sorted")})}function t(aI,aG,aF,aH){k(aI,aG,aF,aH);d(1)}function k(aI,aG,aF,aH){a.each(aG,function(aK,aJ){aJ.sortKey=O[aE.elementType].extractTextFn(aJ,aF)});aG.sort(function(aK,aJ){var aL=aB(aF);return aL(aK.sortKey,aJ.sortKey,aH)});a.each(aG,function(aK,aJ){aI.append(aJ);aJ.sortKey=null})}compare={sortItems:function(aF,aH,aG){if(aG==undefined){aG=1}if(typeof aH=="string"){aH=compare[aH]}aF.sort(function(aJ,aI){return aH(aJ,aI,aG)});return aF},compareAmount:function(aG,aF,aH){return compare.compare(compare.convertAmount(aG),compare.convertAmount(aF),aH)},comparePeriod:function(aG,aF,aH){return compare.compare(compare.convertPeriod(aG),compare.convertPeriod(aF),aH)},compareCurrency:function(aG,aF,aH){return compare.compare(parseFloat(utils.extractCurrencyValue(aG)),parseFloat(utils.extractCurrencyValue(aF)),aH)
},compare:function(aG,aF,aH){if(!aH){aH=1}return((aG<aF)?-aH:((aG>aF)?aH:0))},strPad:function(aG,aF,aH){var aI=aG.toString().trim();if(!aH){aH="0"}while(aI.length<aF){aI=aH+aI}return aI},convertAmount:function(aF){var aF=aF.replace("GB","000000").replace("MB","000");if(!utils.containsNumber(aF)){aF=(aF=="Unlimited")?Number.MAX_VALUE:"0"}return compare.strPad(aF,10)},convertPeriod:function(aF){var aF=aF.toUpperCase().replace(" DAYS","").replace(" MONTHS","00");return compare.strPad(aF,10)}};utils={extractCurrencyValue:function(aG){if(aG==undefined){return""}var aF=aG.trim();if(aG.indexOf("£")!=-1){return utils.replaceAll(aF,"£","")}else{if(aF=="Free"||aF==""){return"0"}else{return aG}}},substringAfterLast:function(aG,aF){return(aG.indexOf(aF)>-1)?aG.substring(aG.lastIndexOf(aF)+1):""},contains:function(aF,aG){return(aF)&&aF.indexOf(aG)!=-1},exists:function(aF){return a(aF).length>0},now:function(){return new Date().getTime()},replaceAll:function(aF,aG,aH){return aF.replace(new RegExp(aG,"g"),aH)},startsWith:function(aF,aG){return aF.indexOf(aG)==0},containsNumber:function(aF){return/\d/.test(aF)},isAlphaNumeric:function(aF){return(aF.match(/^[0-9a-zA-Z ]+$/))?true:false},substringBeforeFirst:function(aH,aG){var aF=aH.indexOf(aG);return(aF>-1)?aH.substring(0,aF):aH}};var u={"default":compare.compare,amount:compare.compareAmount,currency:compare.compareCurrency,period:compare.comparePeriod};var T={select:ab,multiSelect:z,checkboxes:ae,min:N,max:ag,minMax:c,minWithBanding:V,maxWithBanding:ak};var O={TABLE:{getAllDataFn:b,getAllDataForGivenIdFn:aa,extractTextFn:m},UL:{getAllDataFn:ay,getAllDataForGivenIdFn:w,extractTextFn:S}};if(methods[r]){return methods[r].apply(this,Array.prototype.slice.call(arguments,1))}else{if(utils[r]){return utils[r].apply(this,Array.prototype.slice.call(arguments,1))}else{if(compare[r]){return compare[r].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof r==="object"||!r){return methods.init.apply(this,arguments)}else{a.error("No such method: "+r)}}}}}})(jQuery);